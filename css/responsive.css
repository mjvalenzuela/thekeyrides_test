/* Responsive design */
@media (max-width: 992px) {
    #controls-panel {
        padding: 15px;
    }
    
    .legend-panel {
        max-width: 250px;
    }
}

@media (max-width: 768px) {
    #controls-panel {
        left: 5px;
        right: 5px;
        top: 5px;
        padding: 12px;
    }
    
    .control-group {
        flex-direction: column;
        align-items: stretch;
        margin-bottom: 12px;
        gap: 8px;
    }
    
    .control-group h6 {
        align-self: flex-start;
    }
    
    .filters-container {
        justify-content: center;
    }
    
    .legend-panel {
        bottom: 10px;
        left: 10px;
        right: 10px;
        max-width: none;
    }
    
    #location-controls {
        top: 80px;
        right: 10px;
    }
    
    .popup-content {
        max-width: 280px;
    }
    
    .popup-header,
    .popup-body,
    .popup-actions {
        padding: 12px 16px;
    }
}

@media (max-width: 576px) {
    #controls-panel {
        max-height: 50vh;
        overflow-y: auto;
        scrollbar-width: thin;
    }
    
    #controls-panel::-webkit-scrollbar {
        width: 4px;
    }
    
    #controls-panel::-webkit-scrollbar-track {
        background: rgba(0,0,0,0.1);
        border-radius: 4px;
    }
    
    #controls-panel::-webkit-scrollbar-thumb {
        background: rgba(0,0,0,0.3);
        border-radius: 4px;
    }
    
    .filter-checkbox {
        font-size: 12px;
        padding: 4px 8px;
    }
    
    .legend-panel {
        font-size: 12px;
    }
    
    .legend-item {
        margin-bottom: 6px;
    }
    
    .popup-header h4 {
        font-size: 15px;
    }
    
    .popup-body p {
        font-size: 13px;
    }
    
    .error-toast,
    .success-toast,
    .info-toast {
        right: 10px;
        left: 10px;
        max-width: none;
        font-size: 13px;
    }
}

/* Para iframe embebido */
body.embedded #controls-panel {
    top: 5px;
    left: 5px;
    right: 5px;
    padding: 10px;
}

body.embedded .legend-panel {
    bottom: 10px;
    left: 10px;
    right: 10px;
}

body.embedded #location-controls {
    top: 60px;
    right: 10px;
}

/* Animaciones */
@keyframes slideIn {
    from { 
        transform: translateX(100%); 
        opacity: 0; 
    }
    to { 
        transform: translateX(0); 
        opacity: 1; 
    }
}

@keyframes slideOut {
    from { 
        transform: translateX(0); 
        opacity: 1; 
    }
    to { 
        transform: translateX(100%); 
        opacity: 0; 
    }
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes fadeOut {
    from { opacity: 1; }
    to { opacity: 0; }
}

/* Transiciones suaves */
.filter-checkbox,
.legend-item,
.btn-route,
#locate-btn {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Focus states para accesibilidad */
.filter-checkbox:focus-within,
#search-input:focus,
#language-selector:focus,
#locate-btn:focus {
    outline: 2px solid #007cbf;
    outline-offset: 2px;
}

/* Estados de hover mejorados */
.filter-checkbox:hover .category-dot {
    transform: scale(1.1);
}

.legend-item:hover .legend-icon {
    transform: scale(1.05);
}

/* Print styles */
@media print {
    #controls-panel,
    .legend-panel,
    #location-controls {
        display: none;
    }
    
    #map-container {
        width: 100%;
        height: 400px;
    }
}